!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.AnonymousId=t()}(this,function(){"use strict";for(var h=function(e){var a=e.debug;return function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];if(a){var r,n=t[0],i=t.slice(1);(r=console).log.apply(r,["anonymousId."+n].concat(function(e){if(Array.isArray(e)){for(var t=0,o=Array(e.length);t<e.length;t++)o[t]=e[t];return o}return Array.from(e)}(i)))}}},o=[],e=0;e<=15;e++)o.push(e.toString(16));var t=function(){for(var e="",t=1;t<=36;t++)e+=9===t||14===t||19===t||24===t?"-":15===t?4:20===t?o[4*Math.random()|8]:o[15*Math.random()|0];return e},m={segment:{stores:["cookie","localStorage"],key:"ajs_anonymous_id",generateId:function(){return[0<arguments.length&&void 0!==arguments[0]?arguments[0]:"ajs",t()].join("-")},mutate:!0,persist:!0}},v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var o=[],r=!0,n=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(o.push(a.value),!t||o.length!==t);r=!0);}catch(e){n=!0,i=e}finally{try{!r&&u.return&&u.return()}finally{if(n)throw i}}return o}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")};var r={get:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.key;return function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:"").split("; "),t={};if(0===e.length||1===e.length&&""===e[0])return t;for(var o=0;o<e.length;o++){var r=e[o].split("="),n=u(r,2),i=n[0],a=n[1];t[i]=(decodeURIComponent(a)||"").replace(/"/g,"")}return t}(e.cookie)[t]},set:function(){var e,t,o,r,n,i,a,u,c=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},l=c.key,d=c.id,s=c.mutate,f=c.domain,y=c.cookie,g=!1;try{y=document.cookie,g=!0}catch(e){y=""}return g&&(t=(e={name:l,value:d,path:"/",domain:f}).name,o=e.value,r=e.expires,n=e.domain,i=e.path,a=e.secure,u=(u=void 0)!==o&&"object"===(void 0===o?"undefined":v(o))?JSON.stringify(o):encodeURIComponent(o),document.cookie=t+"="+u+(r?"; expires="+new Date(r).toUTCString():"")+"; path="+(i||"/")+(n?"; domain="+n:"")+(a?"; secure":"")),s||(y=""+y),[y,l+"="+encodeURIComponent(d)].filter(Boolean).join("; ")}};var n={get:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.key,o=e.localStorage,r=void 0===o?{}:o;return r.getItem?r.getItem(t):r[t]},set:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.key,o=e.id,r=e.localStorage,n=void 0===r?{}:r,i=e.mutate?n:Object.assign({},n);return i.setItem?i.setItem(t,o):i[t]=o,i}},i={get:{cookie:r.get,localStorage:n.get},set:{cookie:r.set,localStorage:n.set}},k=i.set,p=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.id,o=e.debug,r=e.preset,n=void 0===r?"segment":r,i=e.cookie,a=e.localStorage,u=e.domain,c=h({debug:o});m[n]||(n="segment");var l=m[n],d=l.generateId,s=l.key,f=l.stores,y=l.mutate;c(t?'set: using {id: "'+t+'"}':'set: created new id {id: "'+(t=d())+'"}');var g=void 0;if(!a)try{a=window.localStorage}catch(e){}try{(g=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.debug,o=e.key,r=e.id,n=e.stores,i=e.mutate,a=e.cookie,u=e.localStorage,c=e.domain,l={},d=h({debug:t}),s=!0,f=!1,y=void 0;try{for(var g,v=n[Symbol.iterator]();!(s=(g=v.next()).done);s=!0){var m=g.value;try{var p=k[m],b=p({key:o,id:r,mutate:i,cookie:a,localStorage:u,domain:c});b?(d("set."+m+': success {id: "'+r+'"}'),l[m]=b):d("set."+m+': fail {id: "'+r+'"}')}catch(e){d("set."+m+': fail {id: "'+r+'"}'),console.error(e)}}}catch(e){f=!0,y=e}finally{try{!s&&v.return&&v.return()}finally{if(f)throw y}}return l}({debug:o,key:s,id:t,stores:f,mutate:y,cookie:i,localStorage:a,domain:u})).status="success"}catch(e){c("set: error",e),g={status:"error",error:e}}return g};var b=i.get,a=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.debug,o=e.preset,r=void 0===o?"segment":o,n=e.env,i=void 0===n?"":n,a=e.cookie,u=e.localStorage,c=h({debug:t});m[r]||(r="segment");var l=m[r],d=l.generateId,s=l.key,f=l.stores,y=l.persist;if(function(){return"browser"===(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).env||"undefined"!=typeof window}({env:i})){if(!u)try{u=window.localStorage}catch(e){}if(!a)try{a=document.cookie}catch(e){}var g=function(e){var t=e.debug,o=e.stores,r=e.key,n=e.cookie,i=e.localStorage,a=h({debug:t}),u=!0,c=!1,l=void 0;try{for(var d,s=o[Symbol.iterator]();!(u=(d=s.next()).done);u=!0){var f=d.value,y=b[f],g=y({key:r,cookie:n,localStorage:i});if(g)return a('get.browser: hit {store: "'+f+'", key: "'+r+'"}'),g;a('get.browser: miss {store: "'+f+'", key: "'+r+'"}')}}catch(e){c=!0,l=e}finally{try{!u&&s.return&&s.return()}finally{if(c)throw l}}return""}({debug:t,stores:f,key:s,cookie:a,localStorage:u});if(g)return c('get: found browser id {id: "'+g+'"}'),g}var v=d();return y&&(c('get: persisting new id {id: "'+v+'"}'),p({debug:t,key:s,id:v,cookie:e.cookie,localStorage:e.localStorage})),v};var c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function l(e){return"string"==typeof e||"number"==typeof e?p({id:e}):"object"===(void 0===e?"undefined":c(e))?void 0!==e.id?p(e):a(e):a()}return l.get=a,l.set=p,l});
